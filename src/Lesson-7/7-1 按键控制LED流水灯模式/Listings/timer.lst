C51 COMPILER V9.60.7.0   TIMER                                                             08/20/2023 00:42:29 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\timer.obj
COMPILER INVOKED BY: C:\Program Files\Keil_v5\C51\BIN\C51.EXE lib\timer.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PR
                    -INT(.\Listings\timer.lst) OBJECT(.\Objects\timer.obj)

line level    source

   1          #include "timer.h"
   2          #include "defines.h"
   3          #include "utilities.h"
   4          
   5          // 初始化计数器，每次中断时都要调用
   6          void InitTimer0Counter()
   7          {
   8   1          // 设置计数器初始值，只计数1000次，花费1000us=1ms 产生一次中断
   9   1          TL0 = LOW_8_BIT(T1MS);
  10   1          TH0 = HIGH_8_BIT(T1MS);
  11   1      }
  12          
  13          void Timer0Init()
  14          {
  15   1          /*
  16   1              仅启用Timer0(低4bit)
  17   1              Mode位(第0-1位):    01 - 16位定时器/计数器，TL0、TH0全用
  18   1              C/T位(第2位):       0 - 定时器模式，计数器溢出时产生中断
  19   1              Gate位(第3位):      0 - 用内部信号激活定时器
  20   1          */
  21   1          TMOD |= 0xf1; // 后4位置 0b0001
  22   1          TF0 = 0;      // 初始化进位标志，当定时器溢出时该位为1,向CPU发出中断
  23   1      
  24   1          InitTimer0Counter();
  25   1      
  26   1          TR0 = 1; // Gate = 0, TR0 = 1时, 允许T0开始计数
  27   1      
  28   1          // 配置TF0信号路径
  29   1          ET0 = 1; // 允许Timer0产生中断
  30   1          EA = 1;  // 打开全局中断开关
  31   1          PT0 = 0; // Timer0 产生 低级 中断
  32   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     24    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
